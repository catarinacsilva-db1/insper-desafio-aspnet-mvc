@using CadastroUsuarios.Models
@model IEnumerable<UsuarioModel>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Subtitulo {
    Listagem de Usuários
}

@section Scripts{
    <script src="~/Scripts/CPF/FomatadorCpf.js"></script>
}

@using (Html.BeginForm("Index", "UsuarioCrud", FormMethod.Get))
{
    <div class="d-flex justify-content-start gap-4 mb-4">
        <div class="input-group" style="max-width: 250px;">
            <label class="input-group-text">Filtrar por:</label>
            <select name="filtro" class="form-select" id="filtroStatus" @*onchange="this.form.submit()" ativar submit do filtro*@>
                <option value="todos" @(ViewBag.FiltroAtual == "todos" ? "selected" : "")>
                    Todos
                </option>
                <option value="ativo" @(ViewBag.FiltroAtual == "ativo" ? "selected" : "")>
                    Ativos
                </option>
                <option value="inativo" @(ViewBag.FiltroAtual == "inativo" ? "selected" : "")>
                    Inativos
                </option>
            </select>
        </div>
        <div class="input-group">
            <input type="search" name="termoPesquisa" class="form-control rounded" placeholder="Pesquisar Usuário...." aria-label="Pesquisar Usuário" />
            <button type="submit" class="btn btn-outline-primary">
                <i class="bi bi-search"></i>
            </button>
        </div>
    </div>
}


@if (Model.Any())
{
    <div>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th scope="col">Status</th>
                    <th scope="col">Nome</th>
                    <th scope="col">Sobrenome</th>
                    <th scope="col">Nome Social</th>
                    <th scope="col">Data de Nascimento</th>
                    <th scope="col">CPF</th>
                </tr>
            </thead>
            <tbody>

                @foreach (var user in Model)
                {
                    <tr>
                        <td class="text-center">
                            <i class="@(user.Ativo ? "bi bi-check-circle-fill text-success" : "bi bi-x-circle-fill text-secondary")"
                               title="@(user.Ativo ? "Ativo" : "Inativo")"></i>
                        </td>
                        <td>@user.Nome</td>
                        <td>@user.Sobrenome</td>
                        <td>@user.NomeSocial</td>
                        <td>@user.DataNascimento.ToString("dd/MM/yyyy")</td>
                        <td class="cpf">@user.Cpf</td>

                        <td class="col-2 text-center">
                            <a href="@Url.Action("Edit", "UsuarioCrud", new { id = user.Id })" class="btn btn-default">
                                <i class="bi bi-pencil"></i>
                            </a>
                            <a href="@Url.Action("Deletar", "UsuarioCrud", new { id = user.Id })" class="btn btn-default" data-bs-toggle="modal" data-bs-target="#confirmaDeletar@(user.Id)">
                                <i class="bi bi-trash"></i>
                            </a>
                        </td>
                    </tr>
                    @Html.Partial("_ConfirmarDeletar", user)
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div>
        @Html.Label("", "Nenhum usuário cadastrado.", new { @class = "form-label" })
    </div>
}

<a href="@Url.Action("Cadastrar", "UsuarioCrud")" class="btn btn-primary">Cadastrar</a>
    

